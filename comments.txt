Доброго времени суток!

mart_1

1)Да, использую слегка другой csv файл, совершенно забыл приложить его =( там уже изменены данные с запятой на точку и добавлен столбец timezone с указанием Страна/Город.

2)Заменил F.rank на F.row_number

3)В обновленном csv файле уже указаны часовые пояса (опять-таки забыл выложить его вместе с проектом.)

4)Согласен, добавил Distinct()

5)Да, я сначала добавил "countDistinct()", но в моем спарке почему-то не было этой функции, поэтому пришлось заменить на похожую. Исправил.

6)Интересная мысль. Надеюсь правильно реализовал.

mart_2

1)удалил группировку и изменил на row_number()

mart_3

1)Да, у меня тут умер спарк на компьютере не хватило памяти) теперь понял почему. Изменил как ты посоветовал.



По поводу dag. 